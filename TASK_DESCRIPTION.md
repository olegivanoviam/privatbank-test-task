# PrivatBank Test Task

> **Note:** Table/field/function names in the task should not be taken literally, except where names and types are explicitly specified.

## üá∫üá¶ –¢–µ—Å—Ç–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è

### üìã –í–∏–º–æ–≥–∏ –¥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

#### 1. üìä –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞—Ä—Ç–∏—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–∞—Ä—Ç–∏—Ü—ñ–æ–Ω–æ–≤–∞–Ω—É —Ç–∞–±–ª–∏—Ü—é `–¢1` –∑ –ø–æ–ª—è–º–∏:
- `–¥–∞—Ç–∞` - –¥–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó
- `–∞–π–¥—ñ` - —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä
- `—Å—É–º–∞` - —Å—É–º–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó
- `—Å—Ç–∞–Ω` - —Å—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü—ñ—ó
- `–≥—É—ñ–¥ –æ–ø–µ—Ä–∞—Ü—ñ—ó` - —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π GUID –æ–ø–µ—Ä–∞—Ü—ñ—ó
- `–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è` (JSONB) - JSON –æ–±'—î–∫—Ç, —â–æ –≤–∫–ª—é—á–∞—î:
  - –Ω–æ–º–µ—Ä —Ä–∞—Ö—É–Ω–∫—É
  - –∞–π–¥—ñ –∫–ª—ñ—î–Ω—Ç–∞
  - —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü—ñ—ó (–æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω)

#### 2. üìà –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ `–¢1` –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–±–µ—Ä–µ–∂–µ–Ω–æ—ó –ø—Ä–æ—Ü–µ–¥—É—Ä–∏ —á–∏ —Ñ—É–Ω–∫—Ü—ñ—ó:
- **–ú—ñ–Ω—ñ–º—É–º 100,000 —Ä—è–¥–∫—ñ–≤** –∑–∞–≥–∞–ª–æ–º
- **–ü–µ—Ä—ñ–æ–¥**: —Ç—Ä–∏ –∞–±–æ —á–æ—Ç–∏—Ä–∏ –º—ñ—Å—è—Ü—ñ
- **–†–æ–∑–ø–æ–¥—ñ–ª**: —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∏–π –ø–æ –¥–∞—Ç–∞—Ö

#### 3. üîí –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —É–Ω—ñ–∫–∞–ª—å–Ω–æ—Å—Ç—ñ
–ó–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö –ø–æ –ø–æ–ª—é `–≥—É—ñ–¥ –æ–ø–µ—Ä–∞—Ü—ñ—ó`:
- –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π GUID –¥–ª—è –∫–æ–∂–Ω–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
- –û–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ —Ä—ñ–≤–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

#### 4. ‚è∞ –†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è - –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—ñ–≤
–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫–µ:
- **–ß–∞—Å—Ç–æ—Ç–∞**: –∫–æ–∂–Ω—ñ 5 —Å–µ–∫—É–Ω–¥
- **–î—ñ—è**: –≤–∏–∫–ª–∏–∫–∞—î —Ñ—É–Ω–∫—Ü—ñ—é/–ø—Ä–æ—Ü–µ–¥—É—Ä—É –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –≤ —Ç–∞–±–ª–∏—Ü—é `–¢1`
- **–°—Ç–∞—Ç—É—Å**: `—Å—Ç–∞–Ω` = `0` (–Ω–æ–≤–∏–π –∑–∞–ø–∏—Å)

#### 5. üîÑ –†–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è - –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É
–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫–µ:
- **–ß–∞—Å—Ç–æ—Ç–∞**: –∫–æ–∂–Ω—ñ 3 —Å–µ–∫—É–Ω–¥–∏
- **–î—ñ—è**: –æ–Ω–æ–≤–ª—é—î –ø–æ–ª–µ `—Å—Ç–∞–Ω` —Ç–∞–±–ª–∏—Ü—ñ `–¢1` –∑ `0` –Ω–∞ `1`
- **–õ–æ–≥—ñ–∫–∞**: 
  - –Ø–∫—â–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∫—É–Ω–¥ **–ø–∞—Ä–Ω–∞** ‚Üí –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è **–ø–∞—Ä–Ω—ñ** –∞–π–¥—ñ
  - –Ø–∫—â–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∫—É–Ω–¥ **–Ω–µ–ø–∞—Ä–Ω–∞** ‚Üí –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è **–Ω–µ–ø–∞—Ä–Ω—ñ** –∞–π–¥—ñ

#### 6. üìä –ú–∞—Ç–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è
–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è:
- **–î–∞–Ω—ñ**: –ø–æ—Ç–æ—á–Ω–∞ –∑–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –ø–æ–ª—è `—Å—É–º–∞`
- **–ì—Ä—É–ø—É–≤–∞–Ω–Ω—è**: –ø–æ `–∞–π–¥—ñ –∫–ª—ñ—î–Ω—Ç–∞` —Ç–∞ `—Ç–∏–ø—É` –æ–ø–µ—Ä–∞—Ü—ñ—ó
- **–û–Ω–æ–≤–ª–µ–Ω–Ω—è**: –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –ø–µ—Ä–µ—Ö–æ–¥—ñ `—Å—Ç–∞–Ω` —Ç–∞–±–ª–∏—Ü—ñ `–¢1` –∑ `0` –Ω–∞ `1`

#### 7. üîÑ –†–µ–ø–ª—ñ–∫–∞—Ü—ñ—è
–ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—é —Å—Ç–≤–æ—Ä–µ–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ `–¢1` –Ω–∞ —ñ–Ω—à–∏–π —ñ–Ω—Å—Ç–∞–Ω—Å:
- –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –º—ñ–∂ —ñ–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
- –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ —Ç–∞ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫–æ—Å—Ç—ñ

---

## üá¨üáß Test Task (English)

### üìã Implementation Requirements

#### 1. üìä Create Partitioned Table
Create a partitioned table `T1` with fields:
- `date` - operation date
- `id` - unique identifier
- `amount` - operation amount
- `status` - operation status
- `operation_guid` - unique operation GUID
- `message` (JSONB) - JSON object including:
  - account number
  - customer id
  - operation type (online/offline)

#### 2. üìà Generate Test Data
Generate data to populate table `T1` using a stored procedure or function:
- **Minimum 100,000 rows** in total
- **Period**: three or four months
- **Distribution**: uniform across dates

#### 3. üîí Ensure Uniqueness
Ensure uniqueness of data by the `operation_guid` field:
- Unique GUID for each operation
- Database-level constraint

#### 4. ‚è∞ Scheduled Job - Insert Records
Create a scheduled job that:
- **Frequency**: every 5 seconds
- **Action**: calls function/procedure to insert record into table `T1`
- **Status**: `status` = `0` (new record)

#### 5. üîÑ Scheduled Job - Update Status
Create a scheduled job that:
- **Frequency**: every 3 seconds
- **Action**: updates `status` field in table `T1` from `0` to `1`
- **Logic**:
  - If current seconds value is **even** ‚Üí update **even** ids
  - If current seconds value is **odd** ‚Üí update **odd** ids

#### 6. üìä Materialized View
Create a mechanism to store:
- **Data**: current total of `amount` field
- **Grouping**: by `customer id` and operation `type`
- **Refresh**: on every change of `status` in table `T1` from `0` to `1`

#### 7. üîÑ Replication
Configure replication of the created table `T1` to another instance:
- Data synchronization between instances
- Ensuring reliability and fault tolerance

---

## ‚úÖ Implementation Status

All requirements have been successfully implemented and tested:

- ‚úÖ **Partitioned table T1** - Monthly partitions by date
- ‚úÖ **100k+ test data** - Generated over 3-4 months
- ‚úÖ **Unique operation_guid** - UUID constraint
- ‚úÖ **Scheduled insert job** - Every 5 seconds, status=0
- ‚úÖ **Scheduled update job** - Every 3 seconds, even/odd pattern
- ‚úÖ **Materialized view** - Customer totals with automatic refresh
- ‚úÖ **Logical replication** - Table T1 replicated to standby instance